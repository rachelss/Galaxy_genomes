[["index.html", "Galaxy Bacterial Genomics Workshop Chapter 1 About this workshop", " Galaxy Bacterial Genomics Workshop Rachel Schwartz 2024-01-17 Chapter 1 About this workshop This workshop will go through all of the steps of sequencing, assembling, and examining bacterial genomes. "],["intro.html", "Chapter 2 Introduction 2.1 Introduction 2.2 Case Studies 2.3 Course Objectives 2.4 Genomic data", " Chapter 2 Introduction 2.1 Introduction Biological research is turning to genetic research methods for a deeper look into the biological factors that encode various traits. We can use genetic techniques to delimit species, define populations, understand reproductive patterns systems, and answer many other interesting biological questions. This workshop is designed to allow you to go from bacteria through genome comparisons to identify mutations and structural changes in genomes. This workshop will provide an introduction to next-generation sequencing technology for biologists. 2.2 Case Studies In this course, we will focus on two projects in bacteria. The first project will sequence Haemophilus parainfluenzae, a common commensal organism of the normal oropharynx, recognized as an opportunistic pathogen causing systemic diseases. We will compare strains where particular genes have been deleted to the reference sequence. The second project will compare multiple strains of pathogenic E. coli to identify novel mutations that may be correlated with phenotype. This tutorial steps through the basic process of using Galaxy to assemble and examine these genomes. 2.3 Course Objectives The goals of this course are to give participants a fundamental understanding of how genome sequencing works and how those data are analysed to draw conclusions. 2.4 Genomic data By definition genomes are large. The human genome is 3.2 billion base pairs. Even though bacterial genomes are just 2-4 million base pairs, if you were to go through and compare two genomes by hand to discover the differences between them it would take a while. To add to this complexity, genomes don’t come off the sequencer as a single sequence, but as millions of small fragments or thousands of large ones (depending on the technology). Think of this sequencing method as tossing a book (your genome) into a paper shredder. That means first you have to compare each fragment to a “reference genome” (like the real book) and then figure out where your genome differs from the reference. This is definitely a process you don’t want to do by hand! A computer (at least a big one with lots of computing power) can help us out by automating all these comparisons. That means that before we can identify how the sequence of two samples differ we need to learn to work with the tools to process our data. "],["assembly.html", "Chapter 3 Genome Assembly 3.1 Data 3.2 Getting started with Galaxy 3.3 Getting your sequencing data 3.4 Assembling a genome 3.5 Quality checking the assembly", " Chapter 3 Genome Assembly Note: many of the instructions for this workshop are adapted from work by Phillip Compeau that can be found at https://compeau.cbd.cmu.edu/online-education/sars-cov-2-software-assignments/ as well as Galaxy tutorials found at https://training.galaxyproject.org/training-material/topics/assembly/tutorials/mrsa-nanopore/tutorial.html 3.1 Data In this workshop you have produced genome sequence data in the lab. This file is in FASTQ format, in which each read is represented over four lines described as follows. A header beginning with the “@” symbol and labeling the read. Notice that because these are read pairs, the first two reads’ headers are the same and end with “/1” and “/2”. The read as a sequence of nucleotides. A line containing a “+” symbol to indicate the end of nucleotides. This line may have more header information, but doesn’t for this dataset. A collection of ASCII symbols representing Phred quality scores. The i-th quality score corresponds to the i-th nucleotide in the read. Phred scores are helpful for a variety of reasons. For example, researchers will throw out reads having a significant number of bases that do not meet a certain Phred score threshold, especially if the reads have high coverage. 3.2 Getting started with Galaxy To to all of our work, including genome assembly and annotation, we will use the service Galaxy, an open source project that allows us to run bioinformatics software in the cloud without the hassle of dealing with local installations. You should read more about the Galaxy service, which is funded by the National Institute of Health and the National Science Foundation. Please follow these step-by-step instructions to register on Galaxy: Create an account on Galaxy at https://usegalaxy.org/login. Your “public name” can be whatever you like, but you should fill out all fields. After creating an account, log in to Galaxy. Note that if at some point you have difficulties with this server, try https://usegalaxy.org.au/ Check your email and click the Galaxy link. Click on the plus ‘+’ on the top right of the page and create a new “history” (i.e., project that will contain data and the results of software runs) with a name that is relevant to the data you are analyzing. Some of you are analyzing E. coli and others H. para so please name accordingly in case you want to try another analysis later. All of the following analysis will be performed under this history. If you run a second analysis make sure to make a new history! 3.3 Getting your sequencing data Download your data from the Google Drive that your instructor shared with you. You should see files ending in .fastq.gz . If you have a zipped folder of files make sure to unzip it. Do not unzip the fastq files. In Galaxy, click on the ‘Upload Data’ button on the left side of the screen. Click ‘Choose Local File’ Select all your .fastq.gz files and click Open Click Start When the jobs have completed and are all green on the right side of your main Galaxy page, click on the “eye” symbol next to one of your fastq files under your history on the right side of the page. The page may take a few seconds to load, and Galaxy will show you the first megabyte of your read file. 3.4 Assembling a genome Now that we understand our data a bit better, we are ready to assemble the genome from our data using Flye. Under Genomic File Manipulation - Nanopore on the left side of the page, you will see various tools. Click on Flye, which will take you to its homepage. You need to select the data that Flye will use to assemble your genome. Under Input reads, click on the Multiple Datasets button. Click the drop down arrow and select each dataset one at a time. Leave all the remaining parameters as default. Click Run! The assembly will show up as green in your history when it has completed. This should take ~10-30 minutes depending on the size of the genome. 3.5 Quality checking the assembly Now that Flye has completed, we will analyze the results. 3.5.1 Genome metrics Quast (Gurevich et al. 2013) is a tool providing quality metrics for assemblies, and can also be used to compare multiple assemblies. The tool can also take an optional reference file as input, and will provide complementary metrics. QUAST stands for QUality ASsessment Tool. From the left menus select Genomics Analysis - Assembly - Quast Set parameters as Assembly Mode: Individual Select your assembly Leave all other parameters as defaults Run tool (it should be done in a few minutes) View the HTML report from QUAST by clicking on the ‘eye’ in the analysis on the right. The Quast tool outputs assembly metrics as an html file with metrics and graphs. How many contigs (i.e. genome fragments) did your assembly produce? What is the total read length? Is this what you expect from your sample? (Check out the reference E. coli or the reference H. parainfluenzae) What is the N50 value? 3.5.2 Assessing genome information Busco is a tool used to determine whether your genome has the expected genes for a bacterial genome. From the left menus select Annotation - Busco Run tool Even if it fails click on the “eye” to view the summary analysis. You should see some information about your assembly, particularly how many of the expected genes were not found. How many genes were missing? Congratulations! You have assemble a bacterial genome that no one else has ever seen before! "],["align.html", "Chapter 4 Genome Alignment 4.1 Obtaining a reference genome 4.2 Aligning two samples", " Chapter 4 Genome Alignment 4.1 Obtaining a reference genome To align your assembled genome against a reference genome, we first need to import this reference to Galaxy. The reference we will use for Escherichia coli is a uropathogenic (i.e UTI causing) strain O6:K2:H1 CFT073 (UPEC). Select the “NCBI Accession Download” tool under “Get Data” on the left side of the Galaxy page. Under “Select source for IDs”, select “Direct Entry”. Under ID List, type NC_004431 (for E. coli) or NZ_CP133470.1 (for H. para). Click “Run Tool” 4.2 Aligning two samples Now we are ready to align the two genomes. Under “Multiple Alignments” select “Mummer” For sequence 1, select the reference by clicking the “…” and selecting NC_004431. For sequence 2, select the contigs that you produced with Flye. Keep the other parameters default. Click “Run Tool” This should take a couple of minutes. In the righthand box labeled “Mummer”…“plot” click the “eye” to view the alignment. Diagonal lines indicate sections of the sample genome that align with the reference as in the following example: Our E. coli genes often turn out a lot messier than this example. "],["align2.html", "Chapter 5 Align data to reference 5.1 Align 5.2 Merge 5.3 View 5.4 Variant calling", " Chapter 5 Align data to reference 5.1 Align In cases where we have limited data we may not be able to assemble a genome. However, using a reference genome, we can compare the data to the reference and identify differences even with limited data. Select (from the left menus) Genomics Analysis - Mapping - Minimap2 Click the ‘…’ and select all your datasets Assuming you sequenced E. coli, use CFT076 as your reference It may take some time for all of the alignments to complete. 5.2 Merge It’s useful to merge the multiple output (bam) files into one for convenience. Select (from the left menus) Genomics Toolkits - Picard - MergeSamFiles Select all of the Map with minimap outputs Click Run 5.3 View To view the data as it aligns to the reference do the following. Click (on the left side of screen) “Statistics and Visualization” &gt; “Graph/Display data” &gt; “Jbrowse” Under “Reference genome to display” select E. coli CFT076 Add track group Select track type: BAM pileups Select your merged bam file When the run turns green, click the “eye” in Jbrowse Zoom in to reads to look for variants Find multiple places in the genome where the reads from your sample consistently differ from the reference genome. 5.4 Variant calling The computer can identify locations in the genome with certain differences between your sample and the reference, given the amount of information available. Select Genomic File Manipulation - Nanopore - medaka variant pipeline Specify the model as r104 hac Click Run How many variants were found? "],["annot.html", "Chapter 6 Genome Annotation 6.1 Annotation 6.2 Viewing the annotation", " Chapter 6 Genome Annotation 6.1 Annotation Annotating the genome means that we will identify putative genes and then compare these genes against a database of known genes to find which ones align the best (so we can attach names to them). The identification of putative genes can be done in a variety of ways. One way to find these regions requires the observation that regions of DNA that are translated into protein start with a start codon (ATG) and end with a stop codon (TAG, TAA, or TGA). If a genome were random, then after encountering a start codon, we would expect to see a stop codon after about 64/3 ~ 21 codons. But real genes are typically much, much longer than 21 codons. As a result, in simple organisms like viruses and bacteria, a great way to find genes is to look for long stretches of codons connecting a start codon to a stop codon, with no intermediate stop codons. Once we have found putative genes along the genome, we can compare them against a database of genes using an algorithm called BLAST. These two steps are taken by our next tool, called Prokka, which is used to annotate the genomes of viruses, bacteria, and archaea. Select Prokka under Genomics Analysis - Annotation on the left. Under “Contigs to annotate”, select your contigs from the Flye run. Set “Kingdom” to “Bacteria” and leave all other parameters to default. Note that Prokka only annotates contigs of length at least 200. Click “Run”. The entire process of annotating your genome should not take more than a few minutes. Prokka produces a collection of output files in the history on the right. The .fna file contains the contigs included in the annotation. The .gff file contains regions identified by Prokka as genes. The .ffn file contains nucleotide sequences of the annotated genes, and the .faa file contains their translated amino acid sequences. More detailed descriptions of the outputs can be found at https://github.com/tseemann/prokka#output-files 6.2 Viewing the annotation Prokka contains the annotation information in these files, but what a biologist would really like is a visualization of its genes and what they have been predicted to be. To visualize our annotation contained in the .gff file, we will use a genome browser tool called “JBrowse” Click (on the left side of screen) “Statistics and Visualization” &gt; “Graph/Display data” &gt; “Jbrowse” Under “Reference genome to display” select “use genome from history” Under “Select reference genome” select the .fna file from the prokka annotation outputs. Click “insert track group” and then “insert annotation track” Under “GFF/GFF3/BED Track Data” select the .gff file from the prokka annotation outputs Click “Run tool” JBrowse should be very quick. When it is finished, click view file, which is an HTML file that we can view in the browser. (It may take a moment to load.) On the left side of the page, click on “Prokka on data XXX: gff” to show our annotation of the genome. The arrows point in the direction to indicate which strand of the genome the gene is found on. Click on a gene to obtain information about its length and what in the database it was similar to (if anything). "],["gene.html", "Chapter 7 Working with Target Genes 7.1 Target genes in with a personal computer (if web-only skip to 6.2) 7.2 Target genes in Galaxy (skip this if using JBrowse on your computer) 7.3 Comparing genes between strains (optional) 7.4 Comparing genes to a database 7.5 Comparing across strains 7.6 More genes", " Chapter 7 Working with Target Genes 7.1 Target genes in with a personal computer (if web-only skip to 6.2) 7.1.1 Download and install Jbrowse Download Jbrowse from https://jbrowse.org/jb2/download/ according to your operating system 7.1.2 Obtaining the data from Galaxy In Galaxy Click on the Prokka fna on the righthand menu (history) Click the “save” icon and save the file to your computer Repeat steps 1-2 with the gff file 7.1.3 Your genome in Jbrowse Desktop Open JBrowse on your computer Click “Open Sequence File” Add a name for your Assembly From the drop-down select “FastaAdapter” Click “Choose File” and select your fna/fasta file Click Submit Click “Launch View” Click “Open” Click “Open Track Selector” and check the box for Reference Sequence 7.1.4 Annotation in Jbrowse Desktop Click the orange plus in the lower right Under Main File click “File” Click “Choose File” and select your gff file Click Next Use the trash icons to remove all data from the excluded list Click Add Close the right-hand windows 7.1.5 Finding genes in Jbrowse desktop Take a look at the genes (in orange) labeled in the region of the genome you can observe here. You can click on them for detail and scroll for additional regions of the genome. In the box in the upper center (currently containing a contig and region) delete the existing information and type “rpoS” (don’t include the quotes) Click on the gene to view it Click on the orange bar below the sequence to view the gene in the right-hand panel. Click “Show feature sequence” and copy it Paste the sequence in a plain text document on your computer (not Word!!!) 7.2 Target genes in Galaxy (skip this if using JBrowse on your computer) 7.2.1 Finding gene locations Open the .gbk file from the prokka annotation outputs At the top, press “show all” Use CTRL + F to search for the rpoS gene by typing /gene=“rpoS” Locate the gene on the file and note the CDS position on the line immediately above the gene name Scroll up the file to determine which contig the gene is located on. Before the genes are listed, there is a section of identifying information about the contig. 7.2.2 Observing genes in the genome Go back to Jbrowse Navigate to the target contig using the drop down menu in the center top. In the search bar, input the target region in the format of “contig_x:XX..XX” where x is the contig number and XX..XX is the CDS region. Use the plus and minus buttons to zoom in and out, and the arrows to move left or right (or click and drag within the window to move left or right). Zoom in to see the reference sequence at the top. JBrowse displays the sequence and a 6-frame amino acid translation. 7.3 Comparing genes between strains (optional) Repeat all of the above steps (either 6.1 or 6.2) for the true reference genome to which you want to compare your sample and paste this sequence in a new plain text document. Make sure that the names of the sequences are useful and different! Open needle (left side of screen: Genomic Toolkits &gt; EMBOSS &gt; needle) For Sequence 1 select the … Click the Upload button Click Paste/Fetch data Paste the sequence Repeat steps 2-6 for sequence 2. Click “Run tool” View the alignment and examine for differences between the sequences 7.4 Comparing genes to a database Go to https://blast.ncbi.nlm.nih.gov/Blast.cgi Select Nucleotide Blast Paste your sequence of interest in the box Scroll down and click BLAST Examine the difference between your sample and the first alignment 7.5 Comparing across strains Paste your sequence in the shared Google doc for this gene and make sure it’s labeled with identifying information using the proper fasta format Go to http://translatorx.co.uk/ OR https://www.ebi.ac.uk/Tools/msa/muscle/ Paste all of the sequences from the Google doc into the box Click submit Note - sometimes there are errors in copying data. A single gene for multiple strains of E coli should be nearly identical except for a few variants. If you get an error using translatorx, or you you see a lot of variation when using muscle, delete the sequence that differs significantly and/or attempt to find the correct version of the gene for that strain. How many variants do you see across strains for this particular gene? How many of them are functional? The translatorx alignment will help you see the amino acid sequences while the muscle alignment will help you see all variants. 7.6 More genes In E. coli repeat the gene finding process and comparisons for the following genes: sdhCDAB zapE ihfB sucA sucB sucCD dapD dapE gdhA pykA pykF ghdA zwf gnd "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
