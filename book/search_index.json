[["index.html", "Galaxy Bacterial Genomics Workshop Chapter 1 About this workshop", " Galaxy Bacterial Genomics Workshop Rachel Schwartz 2024-01-05 Chapter 1 About this workshop This workshop will go through all of the steps of sequencing, assembling, and examining bacterial genomes. "],["intro.html", "Chapter 2 Introduction 2.1 Introduction 2.2 Case Studies 2.3 Course Objectives 2.4 Genomic data", " Chapter 2 Introduction 2.1 Introduction Biological research is turning to genetic research methods for a deeper look into the biological factors that encode various traits. We can use genetic techniques to delimit species, define populations, understand reproductive patterns systems, and answer many other interesting biological questions. This workshop is designed to allow you to go from bacteria through genome comparisons to identify mutations and structural changes in genomes. This workshop will provide an introduction to next-generation sequencing technology for biologists. 2.2 Case Studies In this course, we will focus on two projects in bacteria. The first project will sequence Haemophilus parainfluenzae, a common commensal organism of the normal oropharynx, recognized as an opportunistic pathogen causing systemic diseases. We will compare strains where particular genes have been deleted to the reference sequence. The second project will compare multiple strains of pathogenic E. coli to identify novel mutations that may be correlated with phenotype. This tutorial steps through the basic process of using Galaxy to assemble and examine these genomes. 2.3 Course Objectives The goals of this course are to give participants a fundamental understanding of how genome sequencing works and how those data are analysed to draw conclusions. 2.4 Genomic data By definition genomes are large. The human genome is 3.2 billion base pairs. Even though bacterial genomes are just 2-4 million base pairs, if you were to go through and compare two genomes by hand to discover the differences between them it would take a while. To add to this complexity, genomes don’t come off the sequencer as a single sequence, but as millions of small fragments or thousands of large ones (depending on the technology). Think of this sequencing method as tossing a book (your genome) into a paper shredder. That means first you have to compare each fragment to a “reference genome” (like the real book) and then figure out where your genome differs from the reference. This is definitely a process you don’t want to do by hand! A computer (at least a big one with lots of computing power) can help us out by automating all these comparisons. That means that before we can identify how the sequence of two samples differ we need to learn to work with the tools to process our data. "],["assembly.html", "Chapter 3 Genome Assembly 3.1 Data 3.2 Getting started with Galaxy 3.3 Getting your sequencing data 3.4 Assembling a genome 3.5 Analyzing the results of the assembly", " Chapter 3 Genome Assembly Note: many of the instructions for this workshop are adapted from work by Phillip Compeau that can be found at https://compeau.cbd.cmu.edu/online-education/sars-cov-2-software-assignments/ 3.1 Data In this workshop you have produced genome sequence data in the lab. This file is in FASTQ format, in which each read is represented over four lines described as follows. A header beginning with the “@” symbol and labeling the read. Notice that because these are read pairs, the first two reads’ headers are the same and end with “/1” and “/2”. The read as a sequence of nucleotides. A line containing a “+” symbol to indicate the end of nucleotides. This line may have more header information, but doesn’t for this dataset. A collection of ASCII symbols representing Phred quality scores. The i-th quality score corresponds to the i-th nucleotide in the read. Phred scores are helpful for a variety of reasons. For example, researchers will throw out reads having a significant number of bases that do not meet a certain Phred score threshold, especially if the reads have high coverage. 3.2 Getting started with Galaxy To assemble the genome from the reads, we will be using the SPAdes assembler that is the most cited genome assembler of all time. To run SPAdes, we will use the service Galaxy, an open source project that allows us to run often testy bioinformatics software in the cloud without the hassle of dealing with local installations. Please follow these step-by-step instructions to register on Galaxy and run SPAdes: Create an account on Galaxy at https://usegalaxy.org/login. Your “public name” can be whatever you like, but you should fill out all fields. After creating an account, log in to Galaxy. Click on the plus ‘+’ on the top right of the page and create a new “history” (i.e., project that will contain data and the results of software runs) with a name that is relevant to the data you are analyzing. Some of you are analyzing E. coli and others H. para so please name accordingly in case you want to try another analysis later. All of the following analysis will be performed under this history. 3.3 Getting your sequencing data Click on the ‘Upload Data’ button on the left side of the screen. Ask the instructor about uploading the data from your sample onto Galaxy. When the job turns green, click on the “eye” symbol next to one of your fastq files under your history on the right side of the page. The page may take a few seconds to load, and Galaxy will show you the first megabyte of your read file. 3.4 Assembling a genome Now that we understand our data a bit better, we are ready to assemble the genome from our data using SPAdes. Under Genomics Analysis - Assembly on the left side of the page, you will see over a dozen different assemblers. Click on SPAdes, which will take you to its homepage. We will go through each of the settings offered and briefly explain them as well as what we are going to choose. Operation mode: Set to “Assembly and Error Correction” Single-end or paired-end short-reads: Set to single-end for the reads from this sequencer as each read exists independently FASTA/FASTQ file(s): Click on the “multiple datasets” button and then select all of your fastq files one at a time using the drop down menu. Use an additional set of short-reads: Disabled Use all other options as defaults Click Run! The assembly will show up as green in your history when it has completed. 3.5 Analyzing the results of the assembly Now that SPAdes has completed, we will analyze the results. Click on the eye symbol (“view data”) next to the “contigs (fasta)” line on the right side. How many contigs did your assembly produce? What are their lengths? What do you think “coverage” means in this context? "],["align.html", "Chapter 4 Genome Alignment 4.1 Obtaining a reference genome 4.2 Aligning two samples", " Chapter 4 Genome Alignment 4.1 Obtaining a reference genome To align your assembled genome against a reference genome, we first need to import this reference to Galaxy. import this genome, we will use the “NCBI Accession Download” tool under “Get Data” on the left side of the Galaxy page. 4.2 Aligning two samples Now we are ready to align the two genomes. Under the “EMBOSS” section on the left side of the page, click “needle”, which is short for “Needleman-Wunsch global alignment”. For sequence 1, select the contigs that we produced as the result of SPAdes. For sequence 2, select the reference. Keep the other parameters default. After opting for an Email notification, click “Execute”. The algorithm should take a few minutes to run. When the algorithm has finished, view its data. This will show the alignment, in which matches are shown with “|” symbols, mismatches are shown with “.” symbols, and indels do not have a symbol between the two rows. How many matched symbols does the alignment report? How many gap symbols? What do you notice about the ends of the alignment? What do you think happened when the genome was assembled? Scroll through the interior of the alignment. Do you notice any regions that appear to be more variable than other regions? "],["annot.html", "Chapter 5 Genome Annotation 5.1 Annotating 5.2 Viewing the annotation", " Chapter 5 Genome Annotation 5.1 Annotating Finally, we will annotate the genome, meaning that we will identify putative genes and then compare these genes against a database of known genes to find which ones align the best. The identification of putative genes can be done in a variety of ways. One way to find these regions requires the observation that regions of DNA that are translated into protein start with a start codon (ATG) and end with a stop codon (TAG, TAA, or TGA). If a genome were random, then after encountering a start codon, we would expect to see a stop codon after about 64/3 ~ 21 codons. But real genes are typically much, much longer than 21 codons. As a result, in simple organisms like viruses and bacteria, a great way to find genes is to look for long stretches of codons connecting a start codon to a stop codon, with no intermediate stop codons. Once we have found putative genes along the genome, we can compare them against a database of genes using an algorithm called BLAST. These two steps are taken by our next tool, called Prokka, which is used to annotate the genomes of viruses, bacteria, and archaea. It can be found under “Annotation” on Galaxy. Under “Contigs to annotate”, select our contigs from the SPAdes run. Set “Kingdom” to “Bacteria” and leave all other parameters to default. Note that Prokka only annotates contigs of length at least 200. Select whether you would like an Email on completion, and click “Run”. The entire process of annotating our genome should not take more than a few seconds. Isn’t bioinformatics great? Prokka produces a collection of output files in the history on the right. - The .fna file contains the contigs included in the annotation. - The .gff file contains regions identified by Prokka as genes. - The .ffn file contains nucleotide sequences of the annotated genes, and the .faa file contains their translated amino acid sequences. More detailed descriptions of the outputs can be found at https://github.com/tseemann/prokka#output-files View the .gff file containing regions identified by Prokka as putative genes. How many are there? What is the longest and shortest one? 5.2 Viewing the annotation Prokka contains the annotation information in these files, but what a biologist would really like is a visualization of its genes and what they have been predicted to be. So to visualize our annotation contained in the .gff file, we will use a genome browser tool called “JBrowse” Click (on the left side of screen) “Statistics and Visualization” &gt; “Graph/Display data” &gt; “Jbrowse” Under “Reference genome to display” select “use genome from history” Under “Select reference genome” select the .fna file from the prokka annotation outputs. Click “insert track group” and then “insert annotation track” Under “GFF/GFF3/BED Track Data” select the .gff file from the prokka annotation outputs Click “Run tool” Make sure to have both boxes under “Available Tracks” checked on JBrowse should be very quick. When it is finished, click view file, which is an HTML file that we can view in the browser. (It may take a moment to load.) It seems like nothing is there, but on the left side of the page, click on “Prokka on data XXX: gff” to show our annotation of the genome. Zoom out to see it. The arrows point in the direction to indicate which strand of the genome the gene is found on. You can click on the genes as you like to obtain information about their length and what in the database they were found to be similar to (if anything). The annotation score of a protein represents how much experimental evidence backing up this protein. A high score means that if we find a putative gene that is a hit against it, we have a high degree of certainty that our gene serves a similar function. Why do you think that some genes are labeled “hypothetical proteins”? Now we can start investigating the bacteria’s individual genes. Which one should we focus on? How has the gene mutated as the virus spread around the world? And how do these mutations affect the function of the protein? "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
